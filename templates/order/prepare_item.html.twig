{% extends 'base.html.twig' %}

{% block title %}Vychystávání {{ order.number }}{% endblock %}

{% block content %}
    <h1>Vychystávání {{ order.number }}</h1>

    <p>
        <a class="btn btn-outline-secondary" href="{{ path('order_detail', {'id': order.id}) }}">
            <i class="bi bi-arrow-left"></i> Zpět
        </a>
    </p>

    <div class="my-3">
        <twig:BarcodeScanner:PickItemForm order="{{ order }}" />
    </div>

    <div class="table-responsive shadow-lg">
        <table class="table table-hover mb-0">
            <thead class="table-dark">
            <tr>
                <th scope="col">Vychystáno</th>
                <th scope="col">Název</th>
                <th scope="col">EAN</th>
                <th scope="col">Pozice</th>
            </tr>
            </thead>
            <tbody>
                {% for item in order.items %}
                    <tr>
                        <td>
                            {{ item.preparedQuantity }} / {{ item.quantity }}
                            {% if item.fullyPrepared %}
                                <span class="badge bg-success">OK</span>
                            {% endif %}
                        </td>
                        <td>{{ item.title }}</td>
                        <td>{{ item.ean }}</td>
                        <td>
                            {% for stockItem in stockItems[item.ean] ?? [] %}
                                {{ stockItem.position.location.name }} / {{ stockItem.position.name }}
                            {% endfor %}

                            {% if stockItems[item.ean] ?? [] is empty %}
                                <span class="badge bg-danger">Není naskladněno</span>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

{% endblock %}
